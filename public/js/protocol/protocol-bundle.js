function addNewFileInput(){var e=document.getElementById("protocol_files").getElementsByClassName("form-section")[0].getElementsByClassName("form-group")[0],t=document.createElement("label");t.htmlFor="file",t.className="custom-label",e.appendChild(t);var o=document.createElement("div");o.className="flex",t.appendChild(o);var n=document.createElement("input");n.type="file",n.name="file[]",n.placeholder="Select File",n.className="block mt-1",o.appendChild(n);var l=document.createElement("i");l.className="tempFile custom-delete-2 fas fa-times fa-lg",l.title="Click to delete",o.appendChild(l),removeTemporaryFile()}function removeTemporaryFile(){$(".tempFile").off("click").click((function(){this.parentElement.parentElement.remove()}))}$(document).ready((function(){var e=document.getElementById("addFileButton");null!==e&&e.addEventListener("click",addNewFileInput)}));var uploadedFiles=$(".uploaded-file");function deleteFile(e){var t=String(e.getAttribute("data-protocol")),o=String(e.getAttribute("data-file")),n=e.parentElement.getElementsByClassName("download-file")[0].lastChild.nodeValue.trim(),l=$('meta[name="csrf-token"]').attr("content");Swal.fire({html:"<p>Are you sure you want to delete the following file?</p><p><b>"+n+"</b></p>",icon:"warning",showCancelButton:!0,confirmButtonColor:"#10b981",cancelButtonColor:"#d33",confirmButtonText:"Confirm",showLoaderOnConfirm:!0}).then((function(e){e.isConfirmed&&$.ajax({url:window.location.origin+"/deletefile/"+t+"/"+o,method:"post",dataType:"json",data:{_token:l,protocol_id:t,file_id:o},success:function(e){e.success?(Swal.fire("",e.message,"success"),removeDeletedFile(t,o)):Swal.fire("Error!",e.message,"error")},fail:function(e){Swal.fire("Error!",e.message,"error")}})}))}function removeDeletedFile(e,t){var o=$(".uploaded-file[data-file='"+t+"'][data-protocol='"+e+"']")[0];void 0!==o&&o.parentElement.remove()}function cancelProtocol(){protocolStatusChange("Cancellation",{id:document.getElementById("cancelProtocol").value,name:document.getElementById("protocol").textContent,action:"cancel"})}function reactivateProtocol(){protocolStatusChange("Reactivation",{id:document.getElementById("reactivateProtocol").value,name:document.getElementById("protocol").textContent,action:"reactivate"})}function protocolStatusChange(e,t){var o=$('meta[name="csrf-token"]').attr("content");Swal.fire({html:"<p>Please confirm the <b>"+e+"</b> of the following protocol.</p><p><b>"+t.name+"</b></p>",icon:"warning",showCancelButton:!0,confirmButtonColor:"#10b981",cancelButtonColor:"#d33",confirmButtonText:"Confirm",showLoaderOnConfirm:!0}).then((function(e){e.isConfirmed&&$.ajax({url:window.location.origin+"/protocol/change-status",method:"POST",dataType:"JSON",data:{_token:o,id:t.id,action:t.action},success:function(e){e.success?Swal.fire("",e.message,"success").then((function(e){(e.isConfirmed||e.isDismissed)&&window.location.reload()})):Swal.fire("",e.message,"warning").then((function(e){(e.isConfirmed||e.isDismissed)&&window.location.reload()}))},fail:function(e){Swal.fire("",e.message,"error")}})}))}0!==uploadedFiles.length&&uploadedFiles.off("click").click((function(){deleteFile(this)})),$(document).ready((function(){$("#content").find("form").submit((function(){$("#form-loader").removeClass("hidden")}));var e=document.getElementById("reactivateProtocol"),t=document.getElementById("cancelProtocol");null!==e&&e.addEventListener("click",reactivateProtocol),null!==t&&t.addEventListener("click",cancelProtocol)}));
